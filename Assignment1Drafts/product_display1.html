<script src="products.js">

</script>
<script>
    //Code Data retreived from order_page.html in lab 13
    function isNonNegativeInteger(inputString, returnErrors = false) {
        // Validate that an input value is a non-negative integer
        // inputString is the input string; returnErrors indicates how the function returns: true means return the
        // array and false means return a boolean.

        errors = []; // assume no errors at first
        if (Number(inputString) != inputString) {
            errors.push('Not a number!'); // Check if string is a number value
        }
        else {
            if (inputString < 0) errors.push('Negative value!'); // Check if it is non-negative
            if (parseInt(inputString) != inputString) errors.push('Not an integer!'); // Check that it is an integer
        }
        return returnErrors ? errors : (errors.length == 0);
    }

    function displayPurchase() {
        // Display the number of products purchased.
        num_products = quantity_textbox.value;
        if (isNonNegativeInteger(num_products)) {
            document.write(`Thank you for purchasing ${num_products} things!`);
        }
    }

    function checkQuantityTextbox() {
        var errors = isNonNegativeInteger(document.getElementById("quantity_textbox").value, true);
        qty_textbox_message.innerHTML = errors.join(" / ");
    }

    let params = (new URL(document.location)).searchParams;

    // Check if the textbox exists
    if (params.has('quantity_textbox')) {
        // is the quanity valid? If so, print purchase. If not, give error
        if (isNonNegativeInteger(params.get('quantity_textbox'))) {
            document.body.innerHTML = `Thank for you for ordering ${params.get('quantity_textbox')} items`;
        } else {
            document.body.innerHTML = `Invalid quantity bozo - try again`;
        }
    }
    /*if (params.has('error')) {
        err_message = params.get('error')
        alert(err_message);
    }*/
</script>

<form name="quantity_form" action="/process_form" method="POST">
    <script>
        for (i in products) {
            document.write(`<h4>${products[i]["total_sold"]} ${products[i]["name"]} have been sold!</h4>`);
        }
        document.write(`<h3>${products[3]["name"]} at \$${products[3]["price"]}</h3>`);
    </script>
    <input type="text" name="quantity_textbox" onkeyup="checkQuantityTextbox();">
    <span id='qty_textbox_message'>Enter a quantity</span>
    <br>
    <script>
        /*if (params.has('quantity_textbox')) {
            checkIt = params.get('quantity_textbox');
            checkQuantityTextbox(checkIt);
        }*/
        if (params.has('error')) {
            err_message = params.get('error')
            alert(err_message);
        }
    </script>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jewlery Store</title>

    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <style>
        body,h1,h2,h3,h4,h5,h6 {font-family: "Lato", sans-serif}
        .w3-bar,h1,button {font-family: "Montserrat", sans-serif}
        .fa-anchor,.fa-coffee {font-size:200px}
        </style>
     <link href="products-style.css" rel="stylesheet">
</head>
<body>
 <script>
     //Template for header retreived from W3 schools
 </script>
<!-- Header -->
<header class="w3-panel w3-center w3-opacity" style="padding:128px 16px">
    <h1 class="w3-xlarge">Fine Jewlery</h1>
    <h1>Eva Jewlery</h1>
    
    <div class="w3-padding-32">
      <div class="w3-bar w3-border">
        <a href="#" class="w3-bar-item w3-button">Home</a>
        <a href="#" class="w3-bar-item w3-button w3-light-grey">Portfolio</a>
        <a href="#" class="w3-bar-item w3-button">Contact</a>
        <a href="#" class="w3-bar-item w3-button w3-hide-small">Weddings</a>
      </div>
    </div>
  </header>

</body>
</html>