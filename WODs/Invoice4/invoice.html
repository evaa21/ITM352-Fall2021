<script src="product_data.js">
/* This file is a receipt containing 5 products.
   It contains the type of item, the quatity, the price.
   The extended price is quantity multiplied by price.
   The receipt also represents informatio such as the tax rate and the total amount*/
</script>
<script>
  var quantities = [.11,-2,0,'frog',5];

  function generate_item_rows(product_quantities_array){
    for(i in products){
              //Product rows
              if(product_quantities_array[i] == 0)continue;
              errors = isNonNegInt(product_quantities_array[i], true);
              if(errors.length == 0) {
              extended_price = products[i].price*product_quantities_array[i];
              Sub_total += extended_price;
            } else{extended_price = " "
            }
          document.write(`
          <tr>
            <td width="43%">${products[i].brand}</td>
            <td align="center" width="11%">${product_quantities_array[i]}<br><font color="red">${errors.join('<br>')}</font></td>
            <td width="13%">\$${products[i].price}</td>
            <td width="54%">\$${extended_price}</td>
          </tr>
        `);
            }
  }

  function isNonNegInt(inputstring, returnErrors = false) {
    // Validate that an input value is a non negative integer
    // inputstring is the input string; returnErrors indicates how the function returns
    // True means return the array. False is to return a boolean. 
    
    errors = []; // assume no errors at first
    if(Number(inputstring) != inputstring) errors.push('Not a number!'); // Check if string is a number value
    if(inputstring < 0) errors.push('Negative value!'); // Check if it is non-negative
    if(parseInt(inputstring) != inputstring) errors.push('Not an integer!'); // Check that it is an integer
    return returnErrors ? errors : (errors.length == 0);
}
</script>
   <!DOCTYPE html>
   <html lang="en">
   <head>
       <meta charset="UTF-8">
       <meta http-equiv="X-UA-Compatible" content="IE=edge">
       <meta name="viewport" content="width=device-width, initial-scale=1.0">
       <title>Invoice 4</title>

       <script>


     
       </script>
   </head>
   <body>
    <table border="2">
        <tbody>
          <tr>
            
            <th style="text-align: center;" width="43%">Item</th>
            <th style="text-align: center;" width="11%">quantity</th>
            <th style="text-align: center;" width="13%">price</th>
            <th style="text-align: center;" width="54%">extended price</th>
          </tr>
          <script>
            Sub_total=0 
            generate_item_rows(quantities);


            //Sales tax rate and sales tax amount
     var salesTax = .0575;
     var tax_amount = Sub_total*salesTax;
    
     //Shipping
     if(Sub_total <=50){
       shipping = 2;
     }
     else if(Sub_total <= 100){
       shipping = 5
     }
     else {
       shipping = 0.05*Sub_total
     }
     //grand total
     var grand_total = Sub_total+tax_amount+shipping;
     document.write(grand_total.toFixed(2));

        </script>
          <tr>
            <td colspan="4" width="100%">&nbsp;</td>
          </tr>
          <tr>
            <td style="text-align: center;" colspan="3" width="67%">Sub-total</td>
            <td width="54%">$<script>document.write(Sub_total)</script></td>
          </tr>
          <tr>
            <td style="text-align: center;" colspan="3" width="67%"><span style="font-family: arial;">Tax @ 5.75%</span></td>
            <td width="54%">$<script>document.write(tax_amount.toFixed(2))</script></td>
          </tr>
          <tr>
            <td style="text-align: center;" colspan="3" width="67%"><span style="font-family: arial;">Shipping</span></td>
            <td width="54%">$<script>document.write(shipping.toFixed(2))</script></td>
          </tr>
          <tr>
            <td style="text-align: center;" colspan="3" width="67%"><strong>Total</strong></td>
            <td width="54%"><strong>$<script>document.write(grand_total.toFixed(2))</script></strong></td>
          </tr>
        </tbody>
      </table>
      <div>
        <b>
          OUR SHIPPING POLICY IS: <br>A subtotal $0 - $49.99 will be $2 shipping
          <br>A subtotal $50 - $99.99 will be $5 shippinh
          <br>Subtotals over $100 wil be charged 5% of subtotal amount
          </b>
        </b>
      </div>
   </body>
   </html>